
MACRO(DECLARE_MCU mcu source probe)
  OPTION(${mcu} "adding support for ${mcu}")
  LIST(FIND LN_ALL_BOARDS ${mcu} does_exist)
  IF( ${does_exist} EQUAL -1)
    MESSAGE(ERROR "board : ${mcu} is not in available boards!")
    MESSAGE(FATAL_ERROR "available boards: ${LN_ALL_BOARDS}")
  ENDIF( ${does_exist} EQUAL -1)
  LIST(FIND LN_ENABLED_BOARDS ${mcu} is_enabled)
  IF( ${is_enabled} EQUAL -1)
    LIST(APPEND disabled_boards ${mcu})
    FILE(APPEND  ${BOARD_STUB_FILE} "#define LN_BOARD_${mcu}_DISABLED 1\n")
    FILE(APPEND  ${BOARD_STUB_FILE} "BOARD_STUB(${probe});\n")
    FOREACH(other ${ARGN})
      FILE(APPEND  ${BOARD_STUB_FILE} "BOARD_STUB(${other});\n")
    ENDFOREACH()
  ELSE()
    LIST(APPEND enabled_boards ${mcu})
    LIST(APPEND enabled_sources ${T}/${source})
    FILE(APPEND  ${BOARD_STUB_FILE} "#define LN_BOARD_${mcu}_ENABLED 1  /* ON */\n")
    STRING(APPEND STR_BOARD_ENABLED  "${mcu}:")
  ENDIF()
ENDMACRO(DECLARE_MCU mcu source)

MACRO(GENERATE_BOARD_STUB)
  SET(BOARD_STUB_FILE ${CMAKE_BINARY_DIR}/ln_board_stubs.h)
  FILE(WRITE ${BOARD_STUB_FILE} "// Generated by cmake!\n")
  DECLARE_MCU( APOLLO3 apollo3.c  apollo_3_probe)
  DECLARE_MCU( CH32F1 ch32f1.c    ch32f1_probe)
  DECLARE_MCU( EFM32 efm32.c      efm32_probe efm32_aap_probe)
  DECLARE_MCU( IMXRT imxrt.c      imxrt_probe)
  DECLARE_MCU( KINETIS kinetis.c  kinetis_probe kinetis_mdm_probe )
  DECLARE_MCU( LMI lmi.c          lmi_probe)
  DECLARE_MCU( LPC11XX lpc11xx.c  lpc11xx_probe)
  DECLARE_MCU( LPC15XX lpc15xx.c  lpc15xx_probe)
  DECLARE_MCU( LPC17XX lpc17xx.c  lpc17xx_probe)
  DECLARE_MCU( LPC40XX lpc40xx.c  lpc40xx_probe)
  DECLARE_MCU( LPC43XX lpc43xx.c  lpc43xx_probe)
  DECLARE_MCU( LPC546XX lpc546xx.c  lpc546xx_probe )
  DECLARE_MCU( LPC55XX lpc55xx.c  lpc55xx_probe lpc55_dp_prepare lpc55_dmap_probe )
  DECLARE_MCU( MSP432  msp432.c   msp432_probe)
  DECLARE_MCU( MSPM0 mspm0.c  mspm0_probe )
  DECLARE_MCU( NRF51 nrf51.c      nrf51_ctrl_ap_probe nrf51_probe nrf51_mdm_probe )
  DECLARE_MCU( NRF91 nrf91.c      nrf91_probe )
  DECLARE_MCU( NXPKE04 nxpke04.c  ke04_probe )
  DECLARE_MCU( RENESAS_RA renesas_ra.c  renesas_ra_probe )
  DECLARE_MCU( RENESAS_RZ renesas_rz.c  renesas_rz_probe )
  DECLARE_MCU( RP2040 rp2040.c    rp2040_probe rp2040_rescue_probe)
  DECLARE_MCU( RP2350 rp2350.c    rp2350_probe rp2350_rescue_probe)
  DECLARE_MCU( NRF54L nrf54l.c    nrf54l_probe nrf54l_ctrl_ap_probe)
  DECLARE_MCU( SAM3X sam3x.c      sam3x_probe samx7x_probe)
  DECLARE_MCU( SAM4L sam4l.c      sam4l_probe)
  DECLARE_MCU( SAMD samd.c        samd_probe)
  DECLARE_MCU( SAMX5X samx5x.c    samx5x_probe)
  DECLARE_MCU( SFDP sfdp.c        sfdp_probe)
  DECLARE_MCU( STM32F1 stm32f1.c  stm32f1_probe gd32f1_probe mm32f3xx_probe mm32l0xx_probe  at32f40x_probe)
  DECLARE_MCU( STM32F4 stm32f4.c  stm32f4_probe gd32f4_probe)
  DECLARE_MCU( STM32G0 stm32g0.c  stm32g0_probe )
  DECLARE_MCU( STM32H5 stm32h5.c  stm32h5_probe )
  DECLARE_MCU( STM32H7 stm32h7.c  stm32h7_probe )
  DECLARE_MCU( STM32L0 stm32l0.c  stm32l0_probe stm32l1_probe)
  DECLARE_MCU( STM32L4 stm32l4.c  stm32l4_probe )
  DECLARE_MCU( STM32WB0 stm32wb0.c  stm32wb0_probe )
  DECLARE_MCU( STM32MP15 stm32mp15.c stm32mp15_cm4_probe )
  DECLARE_MCU( AT32FXXX  at32f43x.c  at32f43x_probe )
  DECLARE_MCU( MSP432P4  msp432p4.c  msp432p4_probe  )
  DECLARE_MCU( HC32L110  hc32l110.c  hc32l110_probe  )
  DECLARE_MCU( MSP432E4  msp432e4.c  msp432e4_probe  )
  DECLARE_MCU( S32K3XX   s32k3xx.c   s32k3xx_probe  )
  DECLARE_MCU( PUYA      puya.c    puya_probe  )
  DECLARE_MCU( CH579     ch576.c   ch579_probe  )
  FILE(APPEND  ${BOARD_STUB_FILE} "#define LN_BOARDS_ENABLED \"${STR_BOARD_ENABLED}\"\n")
  MESSAGE(STATUS "Enabled boards  : ${enabled_boards}")
  MESSAGE(STATUS "Enabled sources : ${enabled_sources}")
  MESSAGE(STATUS "Disabled boards : ${disabled_boards}")

ENDMACRO()


